# Greeengrass Group definition file
Group:
  name: Modbus-demo
Cores:
  - name: Modbus-demo_core
    key_path: ./certs
    config_path: ./config
    SyncShadow: False

Lambdas:
  - name: ModbusToAWSIoT-demo
    runtime: python2.7
    handler: function.handler
    package: lambdas/ModbusToAWSIoT
    alias: dev
    greengrassConfig:
      MemorySize: 256000 # Kb
      Timeout: 10 # Sec
      Pinned: True # Set True for long-lived functions
      Environment:
        AccessSysfs: False
        Variables:
           INTERVAL: '5'
           HOSTS: '127.0.0.1:5020, localhost:5020'
           UNIT: '1'

  - name: AnomalyCatcher-demo
    runtime: python2.7
    handler: function.handler
    package: lambdas/AnomalyCatcher
    alias: dev
    greengrassConfig:
      MemorySize: 512000 # Kb
      Timeout: 5 # Sec
      Pinned: True # Set True for long-lived functions
      Environment:
        Variables:
           T: '30'

Subscriptions:
  - Source: Lambda::ModbusToAWSIoT-demo
    Subject: '#'
    Target: cloud

  - Source: Lambda::ModbusToAWSIoT-demo
    Subject: 'dt/device_data/#'
    Target: Lambda::AnomalyCatcher-demo

  - Source: Lambda::AnomalyCatcher-demo
    Subject: '#'
    Target: cloud

Loggers:
  - Component: Lambda
    Id: logger_1
    Level: DEBUG
    Space: 1024
    Type: FileSystem
